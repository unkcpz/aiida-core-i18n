

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Setup a code &mdash; AiiDA 1.0.0b2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/contentui.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plugins" href="plugins.html" />
    <link rel="prev" title="Setup a computer" href="computers.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> AiiDA
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/quick_installation.html">Quick installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/updating_installation.html">Updating AiiDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">First things first</a></li>
<li class="toctree-l1"><a class="reference internal" href="daemon.html">Setup the daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="computers.html">Setup a computer</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setup a code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#remote-codes">Remote codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-codes">Local codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-a-code">Setting up a code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/provenance.html">Provenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/calculations.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/workflows.html">Workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../working/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working/functions.html">Calculation and work functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working/calculations.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working/workflows.html">Workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with AiiDA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html">Command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#scripting">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#data-types">Data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#groups">Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#schedulers">Schedulers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#querying-data">Querying data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#caching">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#result-manager">Result manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#backups">Backups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#rest-api">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#cookbook">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import_export/index.html">Import and Export</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html">AiiDA design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html#aiida-core">AiiDA core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html#aiida-plugins">AiiDA plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">StructureData</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html#pseudopotentials">Pseudopotentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html#plugin-development">Plugin development</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="`aiida package &lt;https://aiida-core.readthedocs.io/en/latest/apidoc/aiida.html&gt;`_">`aiida package &lt;https://aiida-core.readthedocs.io/en/latest/apidoc/aiida.html&gt;`_</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AiiDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Setup a code</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/get_started/codes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="setup-a-code">
<span id="setup-code"></span><h1>Setup a code<a class="headerlink" href="#setup-a-code" title="Permalink to this headline">¶</a></h1>
<p>Once you have at least one computer configured, you can configure the codes.
In AiiDA, for full reproducibility of each calculation, we store each code in
the database, and attach to each calculation a given code. This has the further
advantage to make very easy to query for all calculations that were run with
a given code (for instance because I am looking for phonon calculations, or
because I discovered that a specific version had a bug and I want to rerun
the calculations).</p>
<p>In AiiDA, we distinguish two types of codes: <strong>remote</strong> codes and <strong>local</strong> codes,
where the distinction between the two is described here below.</p>
<div class="section" id="remote-codes">
<h2>Remote codes<a class="headerlink" href="#remote-codes" title="Permalink to this headline">¶</a></h2>
<p>With remote codes we denote codes that are installed/compiled
on the remote computer. Indeed, this is very often the case for codes installed
in supercomputers for high-performance computing applications, because the
code is typically installed and optimized on the supercomputer.</p>
<p>In AiiDA, a remote code is identified by two mandatory pieces of information:</p>
<ul class="simple">
<li>A computer on which the code is (that must be a previously configured computer);</li>
<li>The absolute path of the code executable on the remote computer.</li>
</ul>
</div>
<div class="section" id="local-codes">
<h2>Local codes<a class="headerlink" href="#local-codes" title="Permalink to this headline">¶</a></h2>
<p>With local codes we denote codes for which the code is not
already present on the remote machine, and must be copied for every submission.
This is the case if you have for instance a small, machine-independent Python
script that you did not copy previously in all your clusters.</p>
<p>In AiiDA, a local code can be set up by specifying:</p>
<ul class="simple">
<li>A folder, containing all files to be copied over at every submission</li>
<li>The name of executable file among the files inside the folder specified above</li>
</ul>
</div>
<div class="section" id="setting-up-a-code">
<h2>Setting up a code<a class="headerlink" href="#setting-up-a-code" title="Permalink to this headline">¶</a></h2>
<p>The:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">verdi</span> <span class="n">code</span>
</pre></div>
</div>
<p>command allows to manage codes in AiiDA.</p>
<p>To setup a new code, you execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">verdi</span> <span class="n">code</span> <span class="n">setup</span>
</pre></div>
</div>
<p>and you will be guided through a process to setup your code.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The code will ask you a few pieces of information. At every prompt, you can
type the <code class="docutils literal notranslate"><span class="pre">?</span></code> character and press <code class="docutils literal notranslate"><span class="pre">&lt;enter&gt;</span></code> to get a more detailed
explanation of what is being asked.</p>
</div>
<p>You will be asked for:</p>
<ul class="simple">
<li><strong>label</strong>:  A label to refer to this code. Note: this label is not enforced
to be unique. However, if you try to keep it unique, at least within
the same computer, you can use it later
to refer and use to your code. Otherwise, you need to remember its ID or UUID.</li>
<li><strong>description</strong>: A human-readable description of this code (for instance “Quantum
Espresso v.5.0.2 with 5.0.3 patches, pw.x code, compiled with openmpi”)</li>
<li><strong>default input plugin</strong>: A string that identifies the default input plugin to
be used to generate new calculations to use with this code.
This string has to be a valid string recognized by the <code class="docutils literal notranslate"><span class="pre">CalculationFactory</span></code>
function. To get the list of all available Calculation plugin strings,
use the <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">calculation</span> <span class="pre">plugins</span></code> command. Note: if you do not want to
specify a default input plugin, you can write the string “None”, but this is
strongly discouraged, because then you will not be able to use
the <code class="docutils literal notranslate"><span class="pre">.get_builder</span></code> method of the <code class="docutils literal notranslate"><span class="pre">Code</span></code> object.</li>
<li><strong>local</strong>: either True (for local codes) or False (for remote
codes). For the meaning of the distinction, see above. Depending
on your choice, you will be asked for:<ul>
<li>LOCAL CODES:<ul>
<li><strong>Folder with the code</strong>: The folder on your local computer in which there
are the files to be stored in the AiiDA repository, and that will then be
copied over to the remote computers for every submitted calculation.
This must be an absolute path on your computer.</li>
<li><strong>Relative path of the executable</strong>: The relative path of the executable
file inside the folder entered in the previous step.</li>
</ul>
</li>
<li>REMOTE CODES:<ul>
<li><strong>Remote computer name</strong>: The computer name as on which the code resides,
as configured and stored in the AiiDA database</li>
<li><strong>Remote absolute path</strong>: The (full) absolute path of the code executable
on the remote machine</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>For any type of code, you will also be asked for:</p>
<ul>
<li><dl class="first docutils">
<dt><strong>Text to prepend to each command execution</strong>: This is a multiline string,</dt>
<dd><p class="first">whose content will be prepended inside the submission script before the
real execution of the job. It is your responsibility to write proper <code class="docutils literal notranslate"><span class="pre">bash</span></code> code!
This is intended for code-dependent code, <strong>like for instance loading the
modules that are required for that specific executable to run</strong>.
Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">intelmpi</span>
</pre></div>
</div>
<p class="last"><em>Remember</em>
<em>to end the input by pressing</em> <code class="docutils literal notranslate"><span class="pre">&lt;CTRL&gt;+D</span></code>.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Text to append to each command execution</strong>: This is a multiline string,
whose content will be appended inside the submission script after the
real execution of the job. It is your responsibility to write proper <code class="docutils literal notranslate"><span class="pre">bash</span></code> code!
This is intended for code-dependent code. <em>Remember</em>
<em>to end the input by pressing</em> <code class="docutils literal notranslate"><span class="pre">&lt;CTRL&gt;+D</span></code>.</p>
</li>
</ul>
<p>At the end, you will get a confirmation command, and also the ID of the code in the
database (the <code class="docutils literal notranslate"><span class="pre">pk</span></code>, i.e. the principal key, and the <code class="docutils literal notranslate"><span class="pre">uuid</span></code>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Codes are a subclass of the <a class="reference internal" href="../apidoc/aiida.orm.nodes.html#aiida.orm.nodes.Node" title="aiida.orm.nodes.Node"><code class="xref py py-class docutils literal notranslate"><span class="pre">Node</span></code></a> class,
and as such you can attach any set of attributes to the code. These can
be extremely useful for querying: for instance, you can attach the version
of the code as an attribute, or the code family (for instance: “pw.x code of
Quantum Espresso”) to later query for all runs done with a pw.x code and
version more recent than 5.0.0, for instance.  However, in the
present AiiDA version you cannot add attributes from the command line using
<code class="docutils literal notranslate"><span class="pre">verdi</span></code>, but you have to do it using Python code.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>You can change the label of a code by using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">verdi</span> <span class="n">code</span> <span class="n">relabel</span> <span class="s2">&quot;ID&quot;</span> <span class="s2">&quot;new-label&quot;</span>
</pre></div>
</div>
<p>(Without the quotation marks!) “ID” can either be the numeric ID (PK) of
the code (preferentially), or possibly its label (or <a class="reference external" href="mailto:label&#37;&#52;&#48;computername">label<span>&#64;</span>computername</a>),
if this string uniquely identifies a code.</p>
<p>You can also list all available codes (and their relative IDs) with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">verdi</span> <span class="n">code</span> <span class="nb">list</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">verdi</span> <span class="pre">code</span> <span class="pre">list</span></code> accepts some flags to filter only codes on a
given computer, only codes using a specific plugin, etc.; use the <code class="docutils literal notranslate"><span class="pre">-h</span></code>
command line option to see the documentation of all possible options.</p>
<p>You can then get the information of a specific code with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">verdi</span> <span class="n">code</span> <span class="n">show</span> <span class="s2">&quot;ID&quot;</span>
</pre></div>
</div>
<p>Finally, to delete a code use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">verdi</span> <span class="n">code</span> <span class="n">delete</span> <span class="s2">&quot;ID&quot;</span>
</pre></div>
</div>
<p class="last">(only if it wasn’t used by any calculation, otherwise an exception
is raised)</p>
</div>
<p>And now, you are ready to launch your calculations!</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plugins.html" class="btn btn-neutral float-right" title="Plugins" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="computers.html" class="btn btn-neutral float-left" title="Setup a computer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (NCCR MARVEL)), Switzerland and ROBERT BOSCH LLC, USA. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>