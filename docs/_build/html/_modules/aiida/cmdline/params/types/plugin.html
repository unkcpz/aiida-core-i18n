

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aiida.cmdline.params.types.plugin &mdash; AiiDA 1.0.0b2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../../../../_static/contentui.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> AiiDA
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../install/quick_installation.html">Quick installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../install/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../install/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../install/updating_installation.html">Updating AiiDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../install/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../get_started/index.html">First things first</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../get_started/daemon.html">Setup the daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../get_started/computers.html">Setup a computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../get_started/codes.html">Setup a code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../get_started/plugins.html">Plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../concepts/provenance.html">Provenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../concepts/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../concepts/calculations.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../concepts/workflows.html">Workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working/functions.html">Calculation and work functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working/calculations.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working/workflows.html">Workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with AiiDA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html">Command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html#scripting">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html#data-types">Data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html#groups">Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html#schedulers">Schedulers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html#querying-data">Querying data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html#caching">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html#result-manager">Result manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html#backups">Backups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html#rest-api">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../working_with_aiida/index.html#cookbook">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../import_export/index.html">Import and Export</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../developer_guide/index.html">AiiDA design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../developer_guide/index.html#aiida-core">AiiDA core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../developer_guide/index.html#aiida-plugins">AiiDA plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../tutorial/index.html">StructureData</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../tutorial/index.html#pseudopotentials">Pseudopotentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../tutorial/index.html#plugin-development">Plugin development</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="`aiida package &lt;https://aiida-core.readthedocs.io/en/latest/apidoc/aiida.html&gt;`_">`aiida package &lt;https://aiida-core.readthedocs.io/en/latest/apidoc/aiida.html&gt;`_</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">AiiDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../../../aiida.html">aiida</a> &raquo;</li>
        
      <li>aiida.cmdline.params.types.plugin</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for aiida.cmdline.params.types.plugin</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">###########################################################################</span>
<span class="c1"># Copyright (c), The AiiDA team. All rights reserved.                     #</span>
<span class="c1"># This file is part of the AiiDA code.                                    #</span>
<span class="c1">#                                                                         #</span>
<span class="c1"># The code is hosted on GitHub at https://github.com/aiidateam/aiida_core #</span>
<span class="c1"># For further information on the license, see the LICENSE.txt file        #</span>
<span class="c1"># For further information please visit http://www.aiida.net               #</span>
<span class="c1">###########################################################################</span>
<span class="sd">&quot;&quot;&quot;Click parameter type for AiiDA Plugins.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span>

<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">import</span> <span class="nn">click</span>

<span class="kn">from</span> <span class="nn">aiida.cmdline.utils</span> <span class="k">import</span> <span class="n">decorators</span>
<span class="kn">from</span> <span class="nn">aiida.common</span> <span class="k">import</span> <span class="n">exceptions</span>
<span class="kn">from</span> <span class="nn">aiida.plugins.entry_point</span> <span class="k">import</span> <span class="n">ENTRY_POINT_STRING_SEPARATOR</span><span class="p">,</span> <span class="n">ENTRY_POINT_GROUP_PREFIX</span><span class="p">,</span> <span class="n">EntryPointFormat</span>
<span class="kn">from</span> <span class="nn">aiida.plugins.entry_point</span> <span class="k">import</span> <span class="n">format_entry_point_string</span><span class="p">,</span> <span class="n">get_entry_point_string_format</span>
<span class="kn">from</span> <span class="nn">aiida.plugins.entry_point</span> <span class="k">import</span> <span class="n">get_entry_point</span><span class="p">,</span> <span class="n">get_entry_points</span><span class="p">,</span> <span class="n">get_entry_point_groups</span>


<div class="viewcode-block" id="PluginParamType"><a class="viewcode-back" href="../../../../../apidoc/aiida.cmdline.params.types.html#aiida.cmdline.PluginParamType">[docs]</a><span class="k">class</span> <span class="nc">PluginParamType</span><span class="p">(</span><span class="n">click</span><span class="o">.</span><span class="n">ParamType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AiiDA Plugin name parameter type.</span>

<span class="sd">    :param group: string or tuple of strings, where each is a valid entry point group. Adding the `aiida.`</span>
<span class="sd">        prefix is optional. If it is not detected it will be prepended internally.</span>
<span class="sd">    :param load: when set to True, convert will not return the entry point, but the loaded entry point</span>

<span class="sd">    Usage::</span>

<span class="sd">        click.option(... type=PluginParamType(group=&#39;aiida.calculations&#39;)</span>

<span class="sd">    or::</span>

<span class="sd">        click.option(... type=PluginParamType(group=(&#39;calculations&#39;, &#39;data&#39;))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;plugin&#39;</span>

<div class="viewcode-block" id="PluginParamType.__init__"><a class="viewcode-back" href="../../../../../apidoc/aiida.cmdline.params.types.html#aiida.cmdline.PluginParamType.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">load</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate that group is either a string or a tuple of valid entry point groups, or if it</span>
<span class="sd">        is not specified use the tuple of all recognized entry point groups.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=keyword-arg-before-vararg</span>
        <span class="n">valid_entry_point_groups</span> <span class="o">=</span> <span class="n">get_entry_point_groups</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">valid_entry_point_groups</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
                <span class="n">invalidated_groups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">group</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">invalidated_groups</span> <span class="o">=</span> <span class="n">group</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;invalid type for group&#39;</span><span class="p">)</span>

            <span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">invalidated_groups</span><span class="p">:</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">grp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">ENTRY_POINT_GROUP_PREFIX</span><span class="p">):</span>
                    <span class="n">grp</span> <span class="o">=</span> <span class="n">ENTRY_POINT_GROUP_PREFIX</span> <span class="o">+</span> <span class="n">grp</span>

                <span class="k">if</span> <span class="n">grp</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_entry_point_groups</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;entry point group </span><span class="si">{}</span><span class="s1"> is not recognized&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">grp</span><span class="p">))</span>

                <span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grp</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_init_entry_points</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span> <span class="o">=</span> <span class="n">load</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">PluginParamType</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="PluginParamType._init_entry_points"><a class="viewcode-back" href="../../../../../apidoc/aiida.cmdline.params.types.html#aiida.cmdline.PluginParamType._init_entry_points">[docs]</a>    <span class="k">def</span> <span class="nf">_init_entry_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populate entry point information that will be used later on.  This should only be called</span>
<span class="sd">        once in the constructor after setting self.groups because the groups should not be changed</span>
<span class="sd">        after instantiation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_entry_points</span> <span class="o">=</span> <span class="p">[(</span><span class="n">group</span><span class="p">,</span> <span class="n">entry_point</span><span class="p">)</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="k">for</span> <span class="n">entry_point</span> <span class="ow">in</span> <span class="n">get_entry_points</span><span class="p">(</span><span class="n">group</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_entry_point_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry_point</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="k">for</span> <span class="n">entry_point</span> <span class="ow">in</span> <span class="n">get_entry_points</span><span class="p">(</span><span class="n">group</span><span class="p">)]</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">groups</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_groups</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_potential_ambiguity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns whether the set of supported entry point groups can lead to ambiguity when only an entry point name</span>
<span class="sd">        is specified. This will happen if one ore more groups share an entry point with a common name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_entry_point_names</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_entry_point_names</span><span class="p">))</span>

<div class="viewcode-block" id="PluginParamType.get_valid_arguments"><a class="viewcode-back" href="../../../../../apidoc/aiida.cmdline.params.types.html#aiida.cmdline.PluginParamType.get_valid_arguments">[docs]</a>    <span class="k">def</span> <span class="nf">get_valid_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of all available plugins for the groups configured for this PluginParamType instance.</span>
<span class="sd">        If the entry point names are not unique, because there are multiple groups that contain an entry</span>
<span class="sd">        point that has an identical name, we need to prefix the names with the full group name</span>

<span class="sd">        :returns: list of valid entry point strings</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_potential_ambiguity</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">EntryPointFormat</span><span class="o">.</span><span class="n">FULL</span>
            <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">format_entry_point_string</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">ep</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span> <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">ep</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_points</span><span class="p">])</span>

        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_entry_point_names</span><span class="p">)</span></div>

<div class="viewcode-block" id="PluginParamType.get_possibilities"><a class="viewcode-back" href="../../../../../apidoc/aiida.cmdline.params.types.html#aiida.cmdline.PluginParamType.get_possibilities">[docs]</a>    <span class="k">def</span> <span class="nf">get_possibilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incomplete</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of plugins starting with incomplete</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">incomplete</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_valid_arguments</span><span class="p">()</span>

        <span class="c1"># If there is a chance of ambiguity we always return the entry point string in FULL format, otherwise</span>
        <span class="c1"># return the possibilities in the same format as the incomplete. Note that this may have some unexpected</span>
        <span class="c1"># effects. For example if incomplete equals `aiida.` or `calculations` it will be detected as the MINIMAL</span>
        <span class="c1"># format, even though they would also be the valid beginnings of a FULL or PARTIAL format, except that we</span>
        <span class="c1"># cannot know that for sure at this time</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_potential_ambiguity</span><span class="p">:</span>
            <span class="n">possibilites</span> <span class="o">=</span> <span class="p">[</span><span class="n">eps</span> <span class="k">for</span> <span class="n">eps</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_valid_arguments</span><span class="p">()</span> <span class="k">if</span> <span class="n">eps</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">incomplete</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">possibilites</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">get_entry_point_string_format</span><span class="p">(</span><span class="n">incomplete</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">entry_point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_points</span><span class="p">:</span>
                <span class="n">entry_point_string</span> <span class="o">=</span> <span class="n">format_entry_point_string</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">entry_point</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">entry_point_string</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">incomplete</span><span class="p">):</span>
                    <span class="n">possibilites</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry_point_string</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">possibilites</span></div>

<div class="viewcode-block" id="PluginParamType.complete"><a class="viewcode-back" href="../../../../../apidoc/aiida.cmdline.params.types.html#aiida.cmdline.PluginParamType.complete">[docs]</a>    <span class="k">def</span> <span class="nf">complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">incomplete</span><span class="p">):</span>  <span class="c1"># pylint: disable=unused-argument</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return possible completions based on an incomplete value</span>

<span class="sd">        :returns: list of tuples of valid entry points (matching incomplete) and a description</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_possibilities</span><span class="p">(</span><span class="n">incomplete</span><span class="o">=</span><span class="n">incomplete</span><span class="p">)]</span></div>

<div class="viewcode-block" id="PluginParamType.get_missing_message"><a class="viewcode-back" href="../../../../../apidoc/aiida.cmdline.params.types.html#aiida.cmdline.PluginParamType.get_missing_message">[docs]</a>    <span class="k">def</span> <span class="nf">get_missing_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Possible arguments are:</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_valid_arguments</span><span class="p">())</span></div>

<div class="viewcode-block" id="PluginParamType.get_entry_point_from_string"><a class="viewcode-back" href="../../../../../apidoc/aiida.cmdline.params.types.html#aiida.cmdline.PluginParamType.get_entry_point_from_string">[docs]</a>    <span class="k">def</span> <span class="nf">get_entry_point_from_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry_point_string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate a given entry point string, which means that it should have a valid entry point string format</span>
<span class="sd">        and that the entry point unambiguously corresponds to an entry point in the groups configured for this</span>
<span class="sd">        instance of PluginParameterType.</span>

<span class="sd">        :returns: the entry point if valid</span>
<span class="sd">        :raises: ValueError if the entry point string is invalid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">entry_point_format</span> <span class="o">=</span> <span class="n">get_entry_point_string_format</span><span class="p">(</span><span class="n">entry_point_string</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">entry_point_format</span> <span class="ow">in</span> <span class="p">(</span><span class="n">EntryPointFormat</span><span class="o">.</span><span class="n">FULL</span><span class="p">,</span> <span class="n">EntryPointFormat</span><span class="o">.</span><span class="n">PARTIAL</span><span class="p">):</span>

            <span class="n">group</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">entry_point_string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">ENTRY_POINT_STRING_SEPARATOR</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">entry_point_format</span> <span class="o">==</span> <span class="n">EntryPointFormat</span><span class="o">.</span><span class="n">PARTIAL</span><span class="p">:</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">ENTRY_POINT_GROUP_PREFIX</span> <span class="o">+</span> <span class="n">group</span>

            <span class="k">if</span> <span class="n">group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;entry point group </span><span class="si">{}</span><span class="s1"> is not supported by this parameter&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">entry_point_format</span> <span class="o">==</span> <span class="n">EntryPointFormat</span><span class="o">.</span><span class="n">MINIMAL</span><span class="p">:</span>

            <span class="n">name</span> <span class="o">=</span> <span class="n">entry_point_string</span>
            <span class="n">matching_groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group</span> <span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">entry_point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entry_points</span> <span class="k">if</span> <span class="n">entry_point</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matching_groups</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;entry point &#39;</span><span class="si">{}</span><span class="s2">&#39; matches more than one valid entry point group [</span><span class="si">{}</span><span class="s2">], &quot;</span>
                                 <span class="s2">&quot;please specify an explicit group prefix&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">matching_groups</span><span class="p">)))</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">matching_groups</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;entry point &#39;</span><span class="si">{}</span><span class="s2">&#39; is not valid for any of the allowed &quot;</span>
                                 <span class="s2">&quot;entry point groups: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">matching_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;invalid entry point string format: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entry_point_string</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">entry_point</span> <span class="o">=</span> <span class="n">get_entry_point</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">EntryPointError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">entry_point</span></div>

<div class="viewcode-block" id="PluginParamType.convert"><a class="viewcode-back" href="../../../../../apidoc/aiida.cmdline.params.types.html#aiida.cmdline.PluginParamType.convert">[docs]</a>    <span class="nd">@decorators</span><span class="o">.</span><span class="n">with_dbenv</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the string value to an entry point instance, if the value can be successfully parsed</span>
<span class="sd">        into an actual entry point. Will raise click.BadParameter if validation fails.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">click</span><span class="o">.</span><span class="n">BadParameter</span><span class="p">(</span><span class="s1">&#39;plugin name cannot be empty&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">entry_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_entry_point_from_string</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">click</span><span class="o">.</span><span class="n">BadParameter</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">exception</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">entry_point</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">LoadingEntryPointError</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">click</span><span class="o">.</span><span class="n">BadParameter</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">exception</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">entry_point</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (NCCR MARVEL)), Switzerland and ROBERT BOSCH LLC, USA. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>