

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aiida.manage.configuration &mdash; AiiDA 1.0.0b2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script type="text/javascript" src="../../../_static/contentui.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> AiiDA
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install/quick_installation.html">Quick installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/updating_installation.html">Updating AiiDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../get_started/index.html">First things first</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../get_started/daemon.html">Setup the daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../get_started/computers.html">Setup a computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../get_started/codes.html">Setup a code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../get_started/plugins.html">Plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/provenance.html">Provenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/calculations.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/workflows.html">Workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../working/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working/functions.html">Calculation and work functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working/calculations.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working/workflows.html">Workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with AiiDA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html">Command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html#scripting">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html#data-types">Data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html#groups">Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html#schedulers">Schedulers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html#querying-data">Querying data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html#caching">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html#result-manager">Result manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html#backups">Backups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html#rest-api">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../working_with_aiida/index.html#cookbook">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../import_export/index.html">Import and Export</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_guide/index.html">AiiDA design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_guide/index.html#aiida-core">AiiDA core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developer_guide/index.html#aiida-plugins">AiiDA plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html">StructureData</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html#pseudopotentials">Pseudopotentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html#plugin-development">Plugin development</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="`aiida package &lt;https://aiida-core.readthedocs.io/en/latest/apidoc/aiida.html&gt;`_">`aiida package &lt;https://aiida-core.readthedocs.io/en/latest/apidoc/aiida.html&gt;`_</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">AiiDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../aiida.html">aiida</a> &raquo;</li>
        
      <li>aiida.manage.configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for aiida.manage.configuration</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">###########################################################################</span>
<span class="c1"># Copyright (c), The AiiDA team. All rights reserved.                     #</span>
<span class="c1"># This file is part of the AiiDA code.                                    #</span>
<span class="c1">#                                                                         #</span>
<span class="c1"># The code is hosted on GitHub at https://github.com/aiidateam/aiida_core #</span>
<span class="c1"># For further information on the license, see the LICENSE.txt file        #</span>
<span class="c1"># For further information please visit http://www.aiida.net               #</span>
<span class="c1">###########################################################################</span>
<span class="c1"># pylint: disable=undefined-variable,wildcard-import,global-statement,redefined-outer-name,cyclic-import</span>
<span class="sd">&quot;&quot;&quot;Modules related to the configuration of an AiiDA instance.&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span>

<span class="kn">from</span> <span class="nn">.config</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.options</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.profile</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">CONFIG</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">PROFILE</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">BACKEND_UUID</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># This will be set to the UUID of the profile as soon as its corresponding backend is loaded</span>

<span class="c1"># This is used (and should be set to true) for the correct compilation of the documentation on readthedocs</span>
<span class="n">IN_RT_DOC_MODE</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">__all__</span> <span class="o">+</span> <span class="n">options</span><span class="o">.</span><span class="n">__all__</span> <span class="o">+</span> <span class="n">profile</span><span class="o">.</span><span class="n">__all__</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;get_config&#39;</span><span class="p">,</span> <span class="s1">&#39;get_config_option&#39;</span><span class="p">,</span> <span class="s1">&#39;load_profile&#39;</span><span class="p">))</span>


<div class="viewcode-block" id="load_profile"><a class="viewcode-back" href="../../../apidoc/aiida.manage.configuration.html#aiida.manage.configuration.load_profile">[docs]</a><span class="k">def</span> <span class="nf">load_profile</span><span class="p">(</span><span class="n">profile</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load a profile.</span>

<span class="sd">    .. note:: if a profile is already loaded and no explicit profile is specified, nothing will be done</span>

<span class="sd">    :param profile: the name of the profile to load, by default will use the one marked as default in the config</span>
<span class="sd">    :return: the loaded `Profile` instance</span>
<span class="sd">    :raises `aiida.common.exceptions.InvalidOperation`: if the backend of another profile has already been loaded</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">aiida.common</span> <span class="k">import</span> <span class="n">InvalidOperation</span>
    <span class="kn">from</span> <span class="nn">aiida.common.log</span> <span class="k">import</span> <span class="n">configure_logging</span>
    <span class="kn">from</span> <span class="nn">aiida.manage.manager</span> <span class="k">import</span> <span class="n">get_manager</span><span class="p">,</span> <span class="n">reset_manager</span>

    <span class="k">global</span> <span class="n">PROFILE</span>
    <span class="k">global</span> <span class="n">BACKEND_UUID</span>

    <span class="c1"># If a profile is loaded and the specified profile name is None or that of the currently loaded, do nothing</span>
    <span class="k">if</span> <span class="n">PROFILE</span> <span class="ow">and</span> <span class="p">(</span><span class="n">profile</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">PROFILE</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="n">profile</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">PROFILE</span>

    <span class="n">profile</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span><span class="o">.</span><span class="n">get_profile</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">BACKEND_UUID</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">BACKEND_UUID</span> <span class="o">!=</span> <span class="n">profile</span><span class="o">.</span><span class="n">uuid</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidOperation</span><span class="p">(</span><span class="s1">&#39;cannot switch profile because backend of another profile is already loaded&#39;</span><span class="p">)</span>

    <span class="c1"># Set the global variable and make sure the repository is configured</span>
    <span class="n">PROFILE</span> <span class="o">=</span> <span class="n">profile</span>
    <span class="n">PROFILE</span><span class="o">.</span><span class="n">configure_repository</span><span class="p">()</span>

    <span class="c1"># Reconfigure the logging to make sure that profile specific logging configuration options are taken into account.</span>
    <span class="c1"># Also set `with_orm=True` to make sure that the `DBLogHandler` is configured as well.</span>
    <span class="n">configure_logging</span><span class="p">(</span><span class="n">with_orm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">manager</span> <span class="o">=</span> <span class="n">get_manager</span><span class="p">()</span>
    <span class="n">manager</span><span class="o">.</span><span class="n">unload_backend</span><span class="p">()</span>
    <span class="n">reset_manager</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">PROFILE</span></div>


<span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="n">create</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Instantiate the Config object representing the configuration file of the current AiiDA instance.</span>

<span class="sd">    :param create: when set to True, will create the configuration file if it does not already exist</span>
<span class="sd">    :return: the config</span>
<span class="sd">    :rtype: :class:`~aiida.manage.configuration.config.Config`</span>
<span class="sd">    :raises aiida.common.MissingConfigurationError: if the configuration file could not be found and create=False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">io</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="kn">from</span> <span class="nn">aiida.common</span> <span class="k">import</span> <span class="n">exceptions</span>
    <span class="kn">from</span> <span class="nn">aiida.common</span> <span class="k">import</span> <span class="n">json</span>
    <span class="kn">from</span> <span class="nn">.config</span> <span class="k">import</span> <span class="n">Config</span>
    <span class="kn">from</span> <span class="nn">.migrations</span> <span class="k">import</span> <span class="n">check_and_migrate_config</span>
    <span class="kn">from</span> <span class="nn">.settings</span> <span class="k">import</span> <span class="n">AIIDA_CONFIG_FOLDER</span><span class="p">,</span> <span class="n">DEFAULT_CONFIG_FILE_NAME</span>
    <span class="kn">from</span> <span class="nn">aiida.manage.external.postgres</span> <span class="k">import</span> <span class="n">DEFAULT_DBINFO</span>

    <span class="k">if</span> <span class="n">IN_RT_DOC_MODE</span><span class="p">:</span>
        <span class="c1"># The following is a dummy config.json configuration that it is used for the</span>
        <span class="c1"># proper compilation of the documentation on readthedocs.</span>
        <span class="k">return</span> <span class="p">({</span>
            <span class="s1">&#39;default_profile&#39;</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>
            <span class="s1">&#39;profiles&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">&#39;AIIDADB_ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;postgresql_psycopg2&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;AIIDADB_BACKEND&#39;</span><span class="p">:</span> <span class="s1">&#39;django&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;AIIDADB_HOST&#39;</span><span class="p">:</span> <span class="n">DEFAULT_DBINFO</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;AIIDADB_PORT&#39;</span><span class="p">:</span> <span class="n">DEFAULT_DBINFO</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;AIIDADB_NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;aiidadb&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;AIIDADB_PASS&#39;</span><span class="p">:</span> <span class="s1">&#39;123&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;default_user_email&#39;</span><span class="p">:</span> <span class="s1">&#39;aiida@epfl.ch&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;TIMEZONE&#39;</span><span class="p">:</span> <span class="s1">&#39;Europe/Zurich&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;AIIDADB_REPOSITORY_URI&#39;</span><span class="p">:</span> <span class="s1">&#39;file:///repository&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;AIIDADB_USER&#39;</span><span class="p">:</span> <span class="s1">&#39;aiida&#39;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">})</span>

    <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">AIIDA_CONFIG_FOLDER</span><span class="p">,</span> <span class="n">DEFAULT_CONFIG_FILE_NAME</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">create</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">MissingConfigurationError</span><span class="p">(</span><span class="s1">&#39;configuration file </span><span class="si">{}</span><span class="s1"> does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">config_dictionary</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
                <span class="n">config_dictionary</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">ConfigurationError</span><span class="p">(</span><span class="s1">&#39;configuration file </span><span class="si">{}</span><span class="s1"> contains invalid JSON&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>

    <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">check_and_migrate_config</span><span class="p">(</span><span class="n">config_dictionary</span><span class="p">))</span>
    <span class="n">config</span><span class="o">.</span><span class="n">store</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">config</span>


<span class="k">def</span> <span class="nf">get_profile</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Return the currently loaded profile.</span>

<span class="sd">    :return: the globally loaded `Profile` instance or `None`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">PROFILE</span>
    <span class="k">return</span> <span class="n">PROFILE</span>


<span class="k">def</span> <span class="nf">reset_profile</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Reset the globally loaded profile.</span>

<span class="sd">    .. warning:: This is experimental functionality and should for now be used only internally. If the reset is unclean</span>
<span class="sd">        weird unknown side-effects may occur that end up corrupting or destroying data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">PROFILE</span>
    <span class="k">global</span> <span class="n">BACKEND_UUID</span>
    <span class="n">PROFILE</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">BACKEND_UUID</span> <span class="o">=</span> <span class="kc">None</span>


<div class="viewcode-block" id="get_config"><a class="viewcode-back" href="../../../apidoc/aiida.manage.configuration.html#aiida.manage.configuration.get_config">[docs]</a><span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="n">create</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the current configuration.</span>

<span class="sd">    If the configuration has not been loaded yet, it will be loaded first and then returned.</span>

<span class="sd">    Note: this function should only be called by parts of the code that expect that a complete AiiDA instance exists,</span>
<span class="sd">    i.e. an AiiDA folder exists and contains a valid configuration file.</span>

<span class="sd">    :return: the config</span>
<span class="sd">    :rtype: :class:`~aiida.manage.configuration.config.Config`</span>
<span class="sd">    :raises aiida.common.ConfigurationError: if the configuration file could not be found, read or deserialized</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">CONFIG</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">CONFIG</span><span class="p">:</span>
        <span class="n">CONFIG</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="n">create</span><span class="o">=</span><span class="n">create</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">CONFIG</span></div>


<div class="viewcode-block" id="get_config_option"><a class="viewcode-back" href="../../../apidoc/aiida.manage.configuration.html#aiida.manage.configuration.get_config_option">[docs]</a><span class="k">def</span> <span class="nf">get_config_option</span><span class="p">(</span><span class="n">option_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the value for the given configuration option.</span>

<span class="sd">    This function will attempt to load the value of the option as defined for the current profile or otherwise as</span>
<span class="sd">    defined configuration wide. If no configuration is yet loaded, this function will fall back on the default that may</span>
<span class="sd">    be defined for the option itself. This is useful for options that need to be defined at loading time of AiiDA when</span>
<span class="sd">    no configuration is yet loaded or may not even yet exist. In cases where one expects a profile to be loaded,</span>
<span class="sd">    preference should be given to retrieving the option through the Config instance and its `get_option` method.</span>

<span class="sd">    :param option_name: the name of the configuration option</span>
<span class="sd">    :return: option value as specified for the profile/configuration if loaded, otherwise option default</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">aiida.common</span> <span class="k">import</span> <span class="n">exceptions</span>

    <span class="n">option</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="n">option_name</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">(</span><span class="n">create</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">ConfigurationError</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">option</span><span class="o">.</span><span class="n">default</span> <span class="k">if</span> <span class="n">option</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">options</span><span class="o">.</span><span class="n">NO_DEFAULT</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">current_profile</span><span class="p">:</span>
            <span class="c1"># Try to get the option for the profile, but do not return the option default</span>
            <span class="n">value_profile</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="n">option_name</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">current_profile</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value_profile</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Value is the profile value if defined or otherwise the global value, which will be None if not set</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value_profile</span> <span class="k">if</span> <span class="n">value_profile</span> <span class="k">else</span> <span class="n">config</span><span class="o">.</span><span class="n">get_option</span><span class="p">(</span><span class="n">option_name</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">value</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (NCCR MARVEL)), Switzerland and ROBERT BOSCH LLC, USA. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>