

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>General comments &mdash; AiiDA 1.0.0b2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/contentui.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction: Pseudopotential families" href="pseudo_tutorial.html" />
    <link rel="prev" title="StructureData" href="../tutorial/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> AiiDA
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/quick_installation.html">Quick installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/updating_installation.html">Updating AiiDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/index.html">First things first</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/daemon.html">Setup the daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/computers.html">Setup a computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/codes.html">Setup a code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/plugins.html">Plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/provenance.html">Provenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/calculations.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/workflows.html">Workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../working/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working/functions.html">Calculation and work functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working/calculations.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working/workflows.html">Workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with AiiDA</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html">Command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#scripting">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#data-types">Data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#groups">Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#schedulers">Schedulers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#querying-data">Querying data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#caching">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#result-manager">Result manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#backups">Backups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#rest-api">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#cookbook">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import_export/index.html">Import and Export</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html">AiiDA design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html#aiida-core">AiiDA core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html#aiida-plugins">AiiDA plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial/index.html">StructureData</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">General comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial">Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="#internals-kinds-and-sites">Internals: Kinds and Sites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conversion-to-from-ase">Conversion to/from ASE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-multiple-species">Creating multiple species</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#conversion-to-from-pymatgen">Conversion to/from pymatgen</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html#pseudopotentials">Pseudopotentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html#plugin-development">Plugin development</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="`aiida package &lt;https://aiida-core.readthedocs.io/en/latest/apidoc/aiida.html&gt;`_">`aiida package &lt;https://aiida-core.readthedocs.io/en/latest/apidoc/aiida.html&gt;`_</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AiiDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tutorial/index.html">StructureData</a> &raquo;</li>
        
      <li>General comments</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/structure_tutorial.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="general-comments">
<span id="structure-tutorial"></span><h1>General comments<a class="headerlink" href="#general-comments" title="Permalink to this headline">¶</a></h1>
<p>This section contains an example of how you can use the
<a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.StructureData" title="aiida.orm.nodes.data.structure.StructureData"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureData</span></code></a> object
to create complex crystals.</p>
<p>With the <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.StructureData" title="aiida.orm.nodes.data.structure.StructureData"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureData</span></code></a> class we did not
try to have a full set of features to manipulate crystal structures.
Indeed, other libraries such as <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/">ASE</a> exist,
and we simply provide easy
ways to convert between the ASE and the AiiDA formats. On the other hand,
we tried to define a “standard” format for structures in AiiDA, that can be
used across different codes.</p>
</div>
<div class="section" id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>Take a look at the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alat</span> <span class="o">=</span> <span class="mf">4.</span> <span class="c1"># angstrom</span>
<span class="n">cell</span> <span class="o">=</span> <span class="p">[[</span><span class="n">alat</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,],</span>
        <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">alat</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,],</span>
        <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">alat</span><span class="p">,],</span>
       <span class="p">]</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">StructureData</span><span class="p">(</span><span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">append_atom</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Fe&#39;</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">append_atom</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="n">alat</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="n">alat</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="n">alat</span><span class="o">/</span><span class="mf">2.</span><span class="p">),</span> <span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>With the commands above, we have created a crystal structure <code class="docutils literal notranslate"><span class="pre">s</span></code> with
a cubic unit cell and lattice parameter of 4 angstrom, and two atoms in the
cell: one iron (Fe) atom in the origin, and one oxygen (O) at the center of
the cube (this cell has been just chosen as an example and most probably does
not exist).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As you can see in the example above, both the cell coordinates and
the atom coordinates are expressed in angstrom, and the position of
the atoms are given in a global absolute reference frame.</p>
</div>
<p>In this way, any periodic structure can be defined. If you want to import
from ASE in order to specify the coordinates, e.g., in terms of the crystal
lattice vectors, see the guide on the conversion to/from ASE below.</p>
<p>When using the <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.StructureData.append_atom" title="aiida.orm.nodes.data.structure.StructureData.append_atom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">append_atom()</span></code></a>
method, further parameters can be passed. In particular, one can specify
the mass of the atom, particularly important if you want e.g. to run a
phonon calculation. If no mass is specified, the mass provided by
<a class="reference external" href="http://www.nist.gov/pml/data/index.cfm">NIST</a> (retrieved in October 2014)
is going to be used. The list of
masses is stored in the module <a class="reference internal" href="../apidoc/aiida.common.html#module-aiida.common.constants" title="aiida.common.constants"><code class="xref py py-mod docutils literal notranslate"><span class="pre">aiida.common.constants</span></code></a>, in the
<code class="docutils literal notranslate"><span class="pre">elements</span></code> dictionary.</p>
<p>Moreover, in the <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.StructureData" title="aiida.orm.nodes.data.structure.StructureData"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureData</span></code></a> class
of AiiDA we also support the storage of crystal structures with alloys,
vacancies or partial occupancies.
In this case, the argument of the parameter <code class="docutils literal notranslate"><span class="pre">symbols</span></code>
should be a list of symbols, if you want to consider an alloy;
moreover, you must pass a <code class="docutils literal notranslate"><span class="pre">weights</span></code> list, with the same length as <code class="docutils literal notranslate"><span class="pre">symbols</span></code>,
and with values between 0. (no occupancy) and 1. (full occupancy), to specify
the fractional occupancy of that site for each of the symbols specified
in the <code class="docutils literal notranslate"><span class="pre">symbols</span></code> list. The sum of
all occupancies must be lower or equal to one; if the sum is lower than one,
it means that there is a given probability of having a vacancy at that
specific site position.</p>
<p>As an example, you could use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">append_atom</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span><span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ba&#39;</span><span class="p">,</span><span class="s1">&#39;Ca&#39;</span><span class="p">],</span><span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.1</span><span class="p">])</span>
</pre></div>
</div>
<p>to add a site at the origin of a structure <code class="docutils literal notranslate"><span class="pre">s</span></code> consisting of an alloy of
90% of Barium and 10% of Calcium (again, just an example).</p>
<p>The following line instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">append_atom</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span><span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Ca&#39;</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
<p>would create a site with 90% probability of being occupied by Calcium, and
10% of being a vacancy.</p>
<p>Utility methods <code class="docutils literal notranslate"><span class="pre">s.is_alloy</span></code> and <code class="docutils literal notranslate"><span class="pre">s.has_vacancies</span></code> can be used to
verify, respectively, if more than one element if given in the symbols list,
and if the sum of all weights is smaller than one.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>if you pass more than one symbol, the method <code class="docutils literal notranslate"><span class="pre">s.is_alloy</span></code> will
always return <code class="docutils literal notranslate"><span class="pre">True</span></code>, even if only one symbol has occupancy 1. and
all others have occupancy zero:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">StructureData</span><span class="p">(</span><span class="n">cell</span><span class="o">=</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">append_atom</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">),</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">is_alloy</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="internals-kinds-and-sites">
<h1>Internals: Kinds and Sites<a class="headerlink" href="#internals-kinds-and-sites" title="Permalink to this headline">¶</a></h1>
<p>Internally, the <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.StructureData.append_atom" title="aiida.orm.nodes.data.structure.StructureData.append_atom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">append_atom()</span></code></a>
method works by manipulating the kinds and sites of the current structure.
Kinds are instances of the <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.Kind" title="aiida.orm.nodes.data.structure.Kind"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kind</span></code></a> class and
represent a chemical species, with given properties (composing element or
elements, occupancies, mass, …) and identified
by a label (normally, simply the element chemical symbol).</p>
<p>Sites are instances of the <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.Site" title="aiida.orm.nodes.data.structure.Site"><code class="xref py py-class docutils literal notranslate"><span class="pre">Site</span></code></a> class
and represent instead each single site. Each site refers
to a <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.Kind" title="aiida.orm.nodes.data.structure.Kind"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kind</span></code></a>  to
identify its properties (which element it is, the mass, …) and to its three
spatial coordinates.</p>
<p>The <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.StructureData.append_atom" title="aiida.orm.nodes.data.structure.StructureData.append_atom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">append_atom()</span></code></a> works in
the following way:</p>
<ul>
<li><p class="first">It creates a new <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.Kind" title="aiida.orm.nodes.data.structure.Kind"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kind</span></code></a>
class with the properties passed as parameters
(i.e., all parameters except <code class="docutils literal notranslate"><span class="pre">position</span></code>).</p>
</li>
<li><p class="first">It tries to identify if an identical Kind already exists in the list
of kinds of the structure (e.g., in the same atom with the same mass was
already previously added). Comparison of kinds is performed using
<a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.Kind.compare_with" title="aiida.orm.nodes.data.structure.Kind.compare_with"><code class="xref py py-meth docutils literal notranslate"><span class="pre">aiida.orm.nodes.data.structure.Kind.compare_with()</span></code></a>, and in particular
it returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the mass and the list of symbols and of weights are
identical (within a threshold). If an identical kind <code class="docutils literal notranslate"><span class="pre">k</span></code> is found,
it simply adds a new site referencing to kind <code class="docutils literal notranslate"><span class="pre">k</span></code> and with the provided
<code class="docutils literal notranslate"><span class="pre">position</span></code>. Otherwise, it appends <code class="docutils literal notranslate"><span class="pre">k</span></code> to the list of kinds of the current
structure and then creates the site referencing to <code class="docutils literal notranslate"><span class="pre">k</span></code>. The name of the
kind is chosen, by default, equal to the name of the chemical symbol (e.g.,
“Fe” for iron).</p>
</li>
<li><p class="first">If you pass more than one species for the same chemical symbol, but e.g. with
different masses, a new kind is created and the name is obtained postponing
an integer to the chemical symbol name. For instance, the following lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">append_atom</span><span class="p">(</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="n">mass</span> <span class="o">=</span> <span class="mf">55.8</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">append_atom</span><span class="p">(</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="n">mass</span> <span class="o">=</span> <span class="mi">57</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">append_atom</span><span class="p">(</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="n">mass</span> <span class="o">=</span> <span class="mi">59</span><span class="p">)</span>
</pre></div>
</div>
<p>will automatically create three kinds, all for iron, with names <code class="docutils literal notranslate"><span class="pre">Fe</span></code>,
<code class="docutils literal notranslate"><span class="pre">Fe1</span></code> and <code class="docutils literal notranslate"><span class="pre">Fe2</span></code>, and masses 55.8, 57. and 59. respecively.</p>
</li>
<li><p class="first">In case of alloys, the kind name is obtained concatenating all chemical
symbols names (and a X is the sum of weights is less than one). The same
rules as above are used to append a digit to the kind name, if needed.</p>
</li>
<li><p class="first">Finally, you can simply specify the kind_name to automatically generate a
new kind with a specific name. This is the case if you want a name different
from the automatically generated one, or for instance if you want to create
two different species with the same properties (same mass, symbols, …).
This is for instance the case in Quantum ESPRESSO in order to describe an
antiferromagnetic cyrstal, with different magnetizations on the different
atoms in the unit cell.</p>
<p>In this case, you can for instance use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">append_atom</span><span class="p">(</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="n">mass</span> <span class="o">=</span> <span class="mf">55.845</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Fe1&#39;</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">append_atom</span><span class="p">(</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="n">mass</span> <span class="o">=</span> <span class="mf">55.845</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Fe2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To create two species <code class="docutils literal notranslate"><span class="pre">Fe1</span></code> and <code class="docutils literal notranslate"><span class="pre">Fe2</span></code> for iron, with the same mass.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You do not need to specify explicitly the mass if the default one
is ok for you. However, when you pass explicitly a name and it coincides
with the name of an existing species, all properties that you
specify must be identical to the ones of the existing species, or the
method will raise an exception.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you prefer to work with the
internal <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.Kind" title="aiida.orm.nodes.data.structure.Kind"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kind</span></code></a>
and <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.Site" title="aiida.orm.nodes.data.structure.Site"><code class="xref py py-class docutils literal notranslate"><span class="pre">Site</span></code></a> classes,
you can obtain the same
result of the two lines above with:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aiida.orm.nodes.data.structure</span> <span class="k">import</span> <span class="n">Kind</span><span class="p">,</span> <span class="n">Site</span>
<span class="n">s</span><span class="o">.</span><span class="n">append_kind</span><span class="p">(</span><span class="n">Kind</span><span class="p">(</span><span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="mf">55.845</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Fe1&#39;</span><span class="p">))</span>
<span class="n">s</span><span class="o">.</span><span class="n">append_kind</span><span class="p">(</span><span class="n">Kind</span><span class="p">(</span><span class="n">symbols</span><span class="o">=</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="mf">55.845</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Fe1&#39;</span><span class="p">))</span>
<span class="n">s</span><span class="o">.</span><span class="n">append_site</span><span class="p">(</span><span class="n">Site</span><span class="p">(</span><span class="n">kind_name</span><span class="o">=</span><span class="s1">&#39;Fe1&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]))</span>
<span class="n">s</span><span class="o">.</span><span class="n">append_site</span><span class="p">(</span><span class="n">Site</span><span class="p">(</span><span class="n">kind_name</span><span class="o">=</span><span class="s1">&#39;Fe2&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="p">[</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</li>
</ul>
</div>
<div class="section" id="conversion-to-from-ase">
<h1>Conversion to/from ASE<a class="headerlink" href="#conversion-to-from-ase" title="Permalink to this headline">¶</a></h1>
<p>If you have an AiiDA structure, you can get an <code class="docutils literal notranslate"><span class="pre">ase.Atom</span></code> object by
just calling the <a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.StructureData.get_ase" title="aiida.orm.nodes.data.structure.StructureData.get_ase"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_ase</span></code></a>
method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ase_atoms</span> <span class="o">=</span> <span class="n">aiida_structure</span><span class="o">.</span><span class="n">get_ase</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As we support alloys and vacancies in AiiDA, while <code class="docutils literal notranslate"><span class="pre">ase.Atom</span></code> does not,
it is not possible to export to ASE a structure with vacancies or alloys.</p>
</div>
<p>If instead you have as ASE Atoms object and you want to load the structure
from it, just pass it when initializing the class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">StructureData</span> <span class="o">=</span> <span class="n">DataFactory</span><span class="p">(</span><span class="s1">&#39;structure&#39;</span><span class="p">)</span>
<span class="c1"># or:</span>
<span class="c1"># from aiida.orm.nodes.data.structure import StructureData</span>
<span class="n">aiida_structure</span> <span class="o">=</span> <span class="n">StructureData</span><span class="p">(</span><span class="n">ase</span> <span class="o">=</span> <span class="n">ase_atoms</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="creating-multiple-species">
<h2>Creating multiple species<a class="headerlink" href="#creating-multiple-species" title="Permalink to this headline">¶</a></h2>
<p>We implemented the possibility of specifying different Kinds (species) in the
ase.atoms and then importing them.</p>
<p>In particular, if you specify atoms with different mass in ASE, during the
import phase different kinds will be created:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">StructureData</span> <span class="o">=</span> <span class="n">DataFactory</span><span class="p">(</span><span class="s2">&quot;structure&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asecell</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">Atoms</span><span class="p">(</span><span class="s1">&#39;Fe2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asecell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">55.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asecell</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="mf">56.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">StructureData</span><span class="p">(</span><span class="n">ase</span><span class="o">=</span><span class="n">asecell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">kind</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">kinds</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span> <span class="n">kind</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">kind</span><span class="o">.</span><span class="n">mass</span>
<span class="go">Fe 55.0</span>
<span class="go">Fe1 56.0</span>
</pre></div>
</div>
<p>Moreover, even if the mass is the same, but you want to get different species,
you can use the ASE <code class="docutils literal notranslate"><span class="pre">tags</span></code> to specify the number to append to the element
symbol in order to get the species name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">StructureData</span> <span class="o">=</span> <span class="n">DataFactory</span><span class="p">(</span><span class="s2">&quot;structure&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asecell</span> <span class="o">=</span> <span class="n">ase</span><span class="o">.</span><span class="n">Atoms</span><span class="p">(</span><span class="s1">&#39;Fe2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asecell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asecell</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">StructureData</span><span class="p">(</span><span class="n">ase</span><span class="o">=</span><span class="n">asecell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">kind</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">kinds</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span> <span class="n">kind</span><span class="o">.</span><span class="n">name</span>
<span class="go">Fe1</span>
<span class="go">Fe2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">in complicated cases (multiple tags, masses, …),
it is possible that exporting a AiiDA structure
to ASE and then importing it again will not perfectly preserve the kinds and
kind names.</p>
</div>
</div>
</div>
<div class="section" id="conversion-to-from-pymatgen">
<h1>Conversion to/from pymatgen<a class="headerlink" href="#conversion-to-from-pymatgen" title="Permalink to this headline">¶</a></h1>
<p>AiiDA structure can be converted to pymatgen’s <a class="reference external" href="http://pymatgen.org/pymatgen.core.html#pymatgen.core.structure.Molecule">Molecule</a> and
<a class="reference external" href="http://pymatgen.org/pymatgen.core.html#pymatgen.core.structure.Structure">Structure</a> objects by using, accordingly,
<a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.StructureData.get_pymatgen_molecule" title="aiida.orm.nodes.data.structure.StructureData.get_pymatgen_molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_pymatgen_molecule</span></code></a>
and
<a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.StructureData.get_pymatgen_structure" title="aiida.orm.nodes.data.structure.StructureData.get_pymatgen_structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_pymatgen_structure</span></code></a>
methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pymatgen_molecule</span>  <span class="o">=</span> <span class="n">aiida_structure</span><span class="o">.</span><span class="n">get_pymatgen_molecule</span><span class="p">()</span>
<span class="n">pymatgen_structure</span> <span class="o">=</span> <span class="n">aiida_structure</span><span class="o">.</span><span class="n">get_pymatgen_structure</span><span class="p">()</span>
</pre></div>
</div>
<p>A single method
<a class="reference internal" href="../apidoc/aiida.orm.nodes.data.html#aiida.orm.nodes.data.structure.StructureData.get_pymatgen" title="aiida.orm.nodes.data.structure.StructureData.get_pymatgen"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_pymatgen</span></code></a> can be
used for both tasks: converting periodic structures (periodic boundary
conditions are met in all three directions) to pymatgen’s Structure and
other structures to pymatgen’s Molecule:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pymatgen_object</span> <span class="o">=</span> <span class="n">aiida_structure</span><span class="o">.</span><span class="n">get_pymatgen</span><span class="p">()</span>
</pre></div>
</div>
<p>It is also possible to convert pymatgen’s Molecule and Structure
objects to AiiDA structures:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">StructureData</span> <span class="o">=</span> <span class="n">DataFactory</span><span class="p">(</span><span class="s2">&quot;structure&quot;</span><span class="p">)</span>
<span class="n">from_mol</span>      <span class="o">=</span> <span class="n">StructureData</span><span class="p">(</span><span class="n">pymatgen_molecule</span><span class="o">=</span><span class="n">mol</span><span class="p">)</span>
<span class="n">from_struct</span>   <span class="o">=</span> <span class="n">StructureData</span><span class="p">(</span><span class="n">pymatgen_structure</span><span class="o">=</span><span class="n">struct</span><span class="p">)</span>
</pre></div>
</div>
<p>Also in this case, a generic converter is provided:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">StructureData</span> <span class="o">=</span> <span class="n">DataFactory</span><span class="p">(</span><span class="s2">&quot;structure&quot;</span><span class="p">)</span>
<span class="n">from_mol</span>      <span class="o">=</span> <span class="n">StructureData</span><span class="p">(</span><span class="n">pymatgen</span><span class="o">=</span><span class="n">mol</span><span class="p">)</span>
<span class="n">from_struct</span>   <span class="o">=</span> <span class="n">StructureData</span><span class="p">(</span><span class="n">pymatgen</span><span class="o">=</span><span class="n">struct</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Converters work with version 3.0.13 or later of
pymatgen. Earlier versions may cause errors.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pseudo_tutorial.html" class="btn btn-neutral float-right" title="Introduction: Pseudopotential families" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../tutorial/index.html" class="btn btn-neutral float-left" title="StructureData" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (NCCR MARVEL)), Switzerland and ROBERT BOSCH LLC, USA. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>