

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Supported schedulers &mdash; AiiDA 1.0.0b2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/contentui.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="About the QueryBuilder" href="../querying/querybuilder/intro.html" />
    <link rel="prev" title="Groups" href="../working_with_aiida/groups.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> AiiDA
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install/quick_installation.html">Quick installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/updating_installation.html">Updating AiiDA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/index.html">First things first</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/daemon.html">Setup the daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/computers.html">Setup a computer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/codes.html">Setup a code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/plugins.html">Plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/provenance.html">Provenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/calculations.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/workflows.html">Workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../working/processes.html">Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working/functions.html">Calculation and work functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working/calculations.html">Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working/workflows.html">Workflows</a></li>
</ul>
<p class="caption"><span class="caption-text">Working with AiiDA</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html">Command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#scripting">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#data-types">Data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#groups">Groups</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../working_with_aiida/index.html#schedulers">Schedulers</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Supported schedulers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pbspro">PBSPro</a></li>
<li class="toctree-l3"><a class="reference internal" href="#slurm">SLURM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sge">SGE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lsf">LSF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#torque">Torque</a></li>
<li class="toctree-l3"><a class="reference internal" href="#direct-execution-bypassing-schedulers">Direct execution (bypassing schedulers)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#job-resources">Job resources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nodenumberjobresource-pbs-like">NodeNumberJobResource (PBS-like)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parenvjobresource-sge-like">ParEnvJobResource (SGE-like)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#querying-data">Querying data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#caching">Caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#result-manager">Result manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#backups">Backups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#rest-api">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_aiida/index.html#cookbook">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import_export/index.html">Import and Export</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html">AiiDA design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html#aiida-core">AiiDA core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html#aiida-plugins">AiiDA plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">StructureData</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html#pseudopotentials">Pseudopotentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html#plugin-development">Plugin development</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="`aiida package &lt;https://aiida-core.readthedocs.io/en/latest/apidoc/aiida.html&gt;`_">`aiida package &lt;https://aiida-core.readthedocs.io/en/latest/apidoc/aiida.html&gt;`_</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AiiDA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../working_with_aiida/index.html">Command line interface</a> &raquo;</li>
        
      <li>Supported schedulers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/scheduler/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="supported-schedulers">
<span id="my-reference-to-scheduler"></span><h1>Supported schedulers<a class="headerlink" href="#supported-schedulers" title="Permalink to this headline">¶</a></h1>
<p>The list below describes the supported <em>schedulers</em>, i.e. the batch job schedulers that manage the job queues and execution on any given computer.</p>
<div class="section" id="pbspro">
<h2>PBSPro<a class="headerlink" href="#pbspro" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://www.pbsworks.com/Product.aspx?id=1">PBSPro</a> scheduler is supported (and it has been tested with version 12.1).</p>
<p>All the main features are supported with this scheduler.</p>
<p>The <a class="reference internal" href="#job-resources"><span class="std std-ref">JobResource</span></a> class to be used when setting the job resources is the <a class="reference internal" href="#nodenumberjobresource"><span class="std std-ref">NodeNumberJobResource (PBS-like)</span></a>.</p>
</div>
<div class="section" id="slurm">
<h2>SLURM<a class="headerlink" href="#slurm" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://computing.llnl.gov/linux/slurm/">SLURM</a> scheduler is supported (and it has been tested with version 2.5.4).</p>
<p>All the main features are supported with this scheduler.</p>
<p>The <a class="reference internal" href="#job-resources"><span class="std std-ref">JobResource</span></a> class to be used when setting the job resources is the <a class="reference internal" href="#nodenumberjobresource"><span class="std std-ref">NodeNumberJobResource (PBS-like)</span></a>.</p>
</div>
<div class="section" id="sge">
<h2>SGE<a class="headerlink" href="#sge" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://www.oracle.com/us/products/tools/oracle-grid-engine-075549.html">SGE</a> scheduler (Sun Grid Engine, now called Oracle Grid Engine)
is supported (and it has been tested with version GE 6.2u3),
together with some of the main variants/forks.</p>
<p>All the main features are supported with this scheduler.</p>
<p>The <a class="reference internal" href="#job-resources"><span class="std std-ref">JobResource</span></a> class to be used when setting the job resources is the <a class="reference internal" href="#parenvjobresource"><span class="std std-ref">ParEnvJobResource (SGE-like)</span></a>.</p>
</div>
<div class="section" id="lsf">
<h2>LSF<a class="headerlink" href="#lsf" title="Permalink to this headline">¶</a></h2>
<p>The IBM <a class="reference external" href="https://www-01.ibm.com/support/knowledgecenter/SSETD4_9.1.3/lsf_welcome.html">LSF</a> scheduler is supported and has been tested with version 9.1.3
on the CERN <cite>lxplus</cite> cluster.</p>
</div>
<div class="section" id="torque">
<h2>Torque<a class="headerlink" href="#torque" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://www.adaptivecomputing.com/products/open-source/torque/">Torque</a> (based on OpenPBS) is supported (and it has been tested with Torque v.2.4.16 from Ubuntu).</p>
<p>All the main features are supported with this scheduler.</p>
<p>The <a class="reference internal" href="#job-resources"><span class="std std-ref">JobResource</span></a> class to be used when setting the job resources is the <a class="reference internal" href="#nodenumberjobresource"><span class="std std-ref">NodeNumberJobResource (PBS-like)</span></a>.</p>
</div>
<div class="section" id="direct-execution-bypassing-schedulers">
<h2>Direct execution (bypassing schedulers)<a class="headerlink" href="#direct-execution-bypassing-schedulers" title="Permalink to this headline">¶</a></h2>
<p>The direct scheduler, to be used mainly for debugging, is an implementation of a scheduler plugin that does not require a real scheduler installed, but instead directly executes a command, puts it in the background, and checks for its process ID (PID) to discover if the execution is completed.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>The direct execution mode is very fragile. Currently, it spawns a separate Bash shell to execute a job and track each shell by process ID (PID). This poses following problems:</p>
<ul class="last simple">
<li>PID numeration is reset during reboots;</li>
<li>PID numeration is different from machine to machine, thus direct execution is <em>not</em> possible in multi-machine clusters, redirecting each SSH login to a different node in round-robin fashion;</li>
<li>there is no real queueing, hence, all calculation started will be run in parallel.</li>
</ul>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Direct execution bypasses schedulers, so it should be used with care in order not to disturb the functioning of machines.</p>
</div>
<p>All the main features are supported with this scheduler.</p>
<p>The <a class="reference internal" href="#job-resources"><span class="std std-ref">JobResource</span></a> class to be used when setting the job resources is the <a class="reference internal" href="#nodenumberjobresource"><span class="std std-ref">NodeNumberJobResource (PBS-like)</span></a></p>
</div>
</div>
<div class="section" id="job-resources">
<span id="id6"></span><h1>Job resources<a class="headerlink" href="#job-resources" title="Permalink to this headline">¶</a></h1>
<p>When asking a scheduler to allocate some nodes/machines for a given job, we have to specify some job resources, such as the number of required nodes or the numbers of MPI processes per node.</p>
<p>Unfortunately, the way of specifying this information is different on different clusters. In AiiDA, this is implemented in different subclasses of the <a class="reference internal" href="../apidoc/aiida.schedulers.html#aiida.schedulers.datastructures.JobResource" title="aiida.schedulers.datastructures.JobResource"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.schedulers.datastructures.JobResource</span></code></a> class. The subclass that should be used is given by the scheduler, as described in the previous section.</p>
<p>The interfaces of these subclasses are not all exactly the same. Instead, specifying the resources is similar to writing a scheduler script.  All classes define at least one method, <a class="reference internal" href="../apidoc/aiida.schedulers.html#aiida.schedulers.datastructures.JobResource.get_tot_num_mpiprocs" title="aiida.schedulers.datastructures.JobResource.get_tot_num_mpiprocs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_tot_num_mpiprocs</span></code></a>, that returns the total number of MPI processes requested.</p>
<p>In the following, the different <a class="reference internal" href="../apidoc/aiida.schedulers.html#aiida.schedulers.datastructures.JobResource" title="aiida.schedulers.datastructures.JobResource"><code class="xref py py-class docutils literal notranslate"><span class="pre">JobResource</span></code></a> subclasses are described:</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#nodenumberjobresource-pbs-like" id="id7">NodeNumberJobResource (PBS-like)</a></li>
<li><a class="reference internal" href="#parenvjobresource-sge-like" id="id8">ParEnvJobResource (SGE-like)</a></li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>you can manually load a <cite>specific</cite> <a class="reference internal" href="../apidoc/aiida.schedulers.html#aiida.schedulers.datastructures.JobResource" title="aiida.schedulers.datastructures.JobResource"><code class="xref py py-class docutils literal notranslate"><span class="pre">JobResource</span></code></a> subclass by directly importing it, e..g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">aiida.schedulers.datastructures</span> <span class="k">import</span> <span class="n">NodeNumberJobResource</span>
</pre></div>
</div>
<p>However, in general, you will pass the fields to set directly to the <a class="reference internal" href="../apidoc/aiida.orm.nodes.process.calculation.html#aiida.orm.nodes.process.calculation.calcjob.CalcJobNode.set_option" title="aiida.orm.nodes.process.calculation.calcjob.CalcJobNode.set_option"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_option</span></code></a> method of a <a class="reference internal" href="../apidoc/aiida.orm.nodes.process.calculation.html#aiida.orm.nodes.process.calculation.calcjob.CalcJobNode" title="aiida.orm.nodes.process.calculation.calcjob.CalcJobNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">CalcJobNode</span></code></a> object with the <code class="docutils literal notranslate"><span class="pre">resources</span></code> key. For instance:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calc</span> <span class="o">=</span> <span class="n">CalcJobNode</span><span class="p">(</span><span class="n">computer</span><span class="o">=...</span><span class="p">)</span> <span class="c1"># select here a given computer configured</span>
                                    <span class="c1"># in AiiDA</span>

<span class="c1"># This assumes that the computer is configured to use a scheduler with</span>
<span class="c1"># job resources of type NodeNumberJobResource</span>
<span class="n">calc</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;resources&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;num_machines&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;num_mpiprocs_per_machine&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="nodenumberjobresource-pbs-like">
<span id="nodenumberjobresource"></span><h2><a class="toc-backref" href="#id7">NodeNumberJobResource (PBS-like)</a><a class="headerlink" href="#nodenumberjobresource-pbs-like" title="Permalink to this headline">¶</a></h2>
<p>This is the way of specifying the job resources in PBS and SLURM. The class is <a class="reference internal" href="../apidoc/aiida.schedulers.html#aiida.schedulers.datastructures.NodeNumberJobResource" title="aiida.schedulers.datastructures.NodeNumberJobResource"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.schedulers.datastructures.NodeNumberJobResource</span></code></a>.</p>
<p>Once an instance of the class is obtained, you have the following fields that you can set:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">res.num_machines</span></code>: specify the number of machines (also called nodes) on which the code should run</li>
<li><code class="docutils literal notranslate"><span class="pre">res.num_mpiprocs_per_machine</span></code>: number of MPI processes to use on each machine</li>
<li><code class="docutils literal notranslate"><span class="pre">res.tot_num_mpiprocs</span></code>: the total number of MPI processes that this job is requesting</li>
<li><code class="docutils literal notranslate"><span class="pre">res.num_cores_per_machine</span></code>: specify the number of cores to use on each machine</li>
<li><code class="docutils literal notranslate"><span class="pre">res.num_cores_per_mpiproc</span></code>: specify the number of cores to run each MPI process</li>
</ul>
<p>Note that you need to specify only two among the first three fields above, for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">NodeNumberJobResource</span><span class="p">()</span>
<span class="n">res</span><span class="o">.</span><span class="n">num_machines</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">res</span><span class="o">.</span><span class="n">num_mpiprocs_per_machine</span> <span class="o">=</span> <span class="mi">16</span>
</pre></div>
</div>
<p>asks the scheduler to allocate 4 machines, with 16 MPI processes on each machine. This will automatically ask for a total of <code class="docutils literal notranslate"><span class="pre">4*16=64</span></code> total number of MPI processes.</p>
<p>The same can be achieved passing the fields directly to the constructor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">NodeNumberJobResource</span><span class="p">(</span><span class="n">num_machines</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">num_mpiprocs_per_machine</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>
</div>
<p>or, even better, directly calling the <a class="reference internal" href="../apidoc/aiida.orm.nodes.process.calculation.html#aiida.orm.nodes.process.calculation.calcjob.CalcJobNode.set_option" title="aiida.orm.nodes.process.calculation.calcjob.CalcJobNode.set_option"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_option</span></code></a> method of the <a class="reference internal" href="../apidoc/aiida.orm.nodes.process.calculation.html#aiida.orm.nodes.process.calculation.calcjob.CalcJobNode" title="aiida.orm.nodes.process.calculation.calcjob.CalcJobNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">CalcJobNode</span></code></a> class (assuming here that <code class="docutils literal notranslate"><span class="pre">calc</span></code> is your calculation object) for the <code class="docutils literal notranslate"><span class="pre">resources</span></code> key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calc</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;resources&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;num_machines&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;num_mpiprocs_per_machine&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you specify res.num_machines, res.num_mpiprocs_per_machine, and res.tot_num_mpiprocs fields (not recommended), make sure that they satisfy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">num_machines</span> <span class="o">*</span> <span class="n">res</span><span class="o">.</span><span class="n">num_mpiprocs_per_machine</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">tot_num_mpiprocs</span>
</pre></div>
</div>
<p class="last">Moreover, if you specify <code class="docutils literal notranslate"><span class="pre">res.tot_num_mpiprocs</span></code>, make sure that this is a multiple of <code class="docutils literal notranslate"><span class="pre">res.num_machines</span></code> and/or <code class="docutils literal notranslate"><span class="pre">res.num_mpiprocs_per_machine</span></code>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When creating a new computer, you will be asked for a <code class="docutils literal notranslate"><span class="pre">default_mpiprocs_per_machine</span></code>. If you specify it, then you can avoid to specify <code class="docutils literal notranslate"><span class="pre">num_mpiprocs_per_machine</span></code> when creating the resources for that computer, and the default number will be used.</p>
<p>Of course, all the requirements between <code class="docutils literal notranslate"><span class="pre">num_machines</span></code>, <code class="docutils literal notranslate"><span class="pre">num_mpiprocs_per_machine</span></code> and <code class="docutils literal notranslate"><span class="pre">tot_num_mpiprocs</span></code> still apply.</p>
<p class="last">Moreover, you can explicitly specify <code class="docutils literal notranslate"><span class="pre">num_mpiprocs_per_machine</span></code> if you want to use a value different from the default one.</p>
</div>
<p>The num_cores_per_machine and num_cores_per_mpiproc fields are optional. If you specify num_mpiprocs_per_machine and num_cores_per_machine fields, make sure that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">num_cores_per_mpiproc</span> <span class="o">*</span> <span class="n">res</span><span class="o">.</span><span class="n">num_mpiprocs_per_machine</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">num_cores_per_machine</span>
</pre></div>
</div>
<p>If you want to specifiy single value in num_mpiprocs_per_machine and  num_cores_per_machine, please make sure that res.num_cores_per_machine is multiple of res.num_cores_per_mpiproc and/or res.num_mpiprocs_per_machine.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In PBSPro, the num_mpiprocs_per_machine and num_cores_per_machine fields are used for mpiprocs and ppn respectively.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In Torque, the num_mpiprocs_per_machine field is used for ppn unless the num_mpiprocs_per_machine is specified.</p>
</div>
</div>
<div class="section" id="parenvjobresource-sge-like">
<span id="parenvjobresource"></span><h2><a class="toc-backref" href="#id8">ParEnvJobResource (SGE-like)</a><a class="headerlink" href="#parenvjobresource-sge-like" title="Permalink to this headline">¶</a></h2>
<p>In SGE and similar schedulers, one has to specify a <em>parallel environment</em> and the <em>total number of CPUs</em> requested. The class is <a class="reference internal" href="../apidoc/aiida.schedulers.html#aiida.schedulers.datastructures.ParEnvJobResource" title="aiida.schedulers.datastructures.ParEnvJobResource"><code class="xref py py-class docutils literal notranslate"><span class="pre">aiida.schedulers.datastructures.ParEnvJobResource</span></code></a>.</p>
<p>Once an instance of the class is obtained, you have the following fields that you can set:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">res.parallel_env</span></code>: specify the parallel environment in which you want to run your job (a string)</li>
<li><code class="docutils literal notranslate"><span class="pre">res.tot_num_mpiprocs</span></code>: the total number of MPI processes that this job is requesting</li>
</ul>
<p>Remember to always specify both fields. No checks are done on the consistency between the specified parallel environment and the total number of MPI processes requested (for instance, some parallel environments may have been configured by your cluster administrator to run on a single machine). It is your responsibility to make sure that the information is valid, otherwise the  submission will fail.</p>
<p>Some examples:</p>
<ul>
<li><p class="first">setting the fields one by one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">ParEnvJobResource</span><span class="p">()</span>
<span class="n">res</span><span class="o">.</span><span class="n">parallel_env</span> <span class="o">=</span> <span class="s1">&#39;mpi&#39;</span>
<span class="n">res</span><span class="o">.</span><span class="n">tot_num_mpiprocs</span> <span class="o">=</span> <span class="mi">64</span>
</pre></div>
</div>
</li>
<li><p class="first">setting the fields directly in the class constructor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">ParEnvJobResource</span><span class="p">(</span><span class="n">parallel_env</span><span class="o">=</span><span class="s1">&#39;mpi&#39;</span><span class="p">,</span> <span class="n">tot_num_mpiprocs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">even better, directly calling the <a class="reference internal" href="../apidoc/aiida.orm.nodes.process.calculation.html#aiida.orm.nodes.process.calculation.calcjob.CalcJobNode.set_option" title="aiida.orm.nodes.process.calculation.calcjob.CalcJobNode.set_option"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_option</span></code></a> method of the <a class="reference internal" href="../apidoc/aiida.orm.nodes.process.calculation.html#aiida.orm.nodes.process.calculation.calcjob.CalcJobNode" title="aiida.orm.nodes.process.calculation.calcjob.CalcJobNode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CalcJobNode</span></code></a> class (assuming here that <code class="docutils literal notranslate"><span class="pre">calc</span></code> is your calculation object) for the <code class="docutils literal notranslate"><span class="pre">resources</span></code> key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calc</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;resources&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;parallel_env&quot;</span><span class="p">:</span> <span class="s1">&#39;mpi&#39;</span><span class="p">,</span> <span class="s2">&quot;tot_num_mpiprocs&quot;</span><span class="p">:</span> <span class="mi">64</span><span class="p">})</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../querying/querybuilder/intro.html" class="btn btn-neutral float-right" title="About the QueryBuilder" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../working_with_aiida/groups.html" class="btn btn-neutral float-left" title="Groups" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE (Theory and Simulation of Materials (THEOS) and National Centre for Computational Design and Discovery of Novel Materials (NCCR MARVEL)), Switzerland and ROBERT BOSCH LLC, USA. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>